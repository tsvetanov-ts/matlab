% Plot_results - results switched

%  GA real valued = [Mmax Ks K1 K5 J]
GA = [0.899999959	0.006000001	2.262033959	1.943441695	121.0830536
0.9	0.006000002	2.262152599	1.943556558	121.0832331
0.9	0.006000189	2.261482205	1.942884793	121.0832766
0.9	0.006	2.261519093	1.942817199	121.0834271
0.899999991	0.006000001	2.261993019	1.943390731	121.08344
0.899999847	0.006000014	2.262055867	1.943493889	121.083493
0.9	0.006000118	2.261383646	1.942813564	121.0835171
0.899881593	0.006005546	2.261496213	1.942733733	121.08359
0.899971043	0.006000125	2.261841169	1.943031474	121.083675
0.899849835	0.006000538	2.26327805	1.944620104	121.0838252
0.899972993	0.00600004	2.26349482	1.944442801	121.0838323
0.899928128	0.006	2.260568585	1.942223221	121.0838718
0.899992638	0.006	2.260792814	1.942159018	121.0840567
0.899971686	0.006000107	2.260745059	1.942017768	121.0841566
0.899988625	0.006000858	2.261858495	1.943402438	121.0841673
0.9	0.006	2.260518117	1.941780083	121.0841862
0.9	0.006000002	2.260064436	1.941422305	121.0845607
0.899994891	0.006000139	2.263676822	1.945160525	121.0848229
0.899931971	0.006000213	2.259798091	1.941153386	121.0849681
0.89997936	0.006	2.264305462	1.945696776	121.0850746
0.899991777	0.00600008	2.264065632	1.945212805	121.085188
0.899995544	0.006000213	2.258830709	1.939887497	121.0872121
0.899906429	0.006000509	2.2591847	1.940244767	121.0873286
0.89999924	0.006000775	2.26497564	1.946698325	121.0874167
0.899990138	0.006	2.258594411	1.939930004	121.0881112
0.899993623	0.006000154	2.25827107	1.939989067	121.0881716
0.899985606	0.006001025	2.265475668	1.946598657	121.088255
0.899956824	0.006003789	2.257525717	1.938892054	121.0912129
0.899962252	0.00600087	2.266950569	1.947765467	121.0922582
0.899992665	0.006001242	2.269091706	1.950324443	121.1000873];

CSA = [0.88769421870216	0.00535415019647	2.24984630248432	1.94337548533764	120.17307273937000
0.887923124	0.005397484	2.253129648	1.945976398	120.17701
0.875803112	0.005215396	2.250126012	1.942417784	120.1759628
0.87862732	0.005268592	2.252159943	1.943804604	120.1778241
0.884146717	0.005354352	2.254080829	1.946202089	120.1787957
0.899111441	0.005557351	2.251724178	1.946335746	120.1788021
0.882471406	0.005329809	2.247261449	1.941978875	120.1794127
0.869482229	0.005116248	2.25012102	1.941469272	120.1814785
0.864469546	0.005014293	2.249862143	1.941676406	120.181962
0.890101987	0.005267268	2.255058135	1.945025985	120.1824868
0.895038914	0.00550076	2.255250809	1.947525862	120.1841403
0.895414037	0.005423725	2.253099952	1.943561199	120.1844113
0.897539015	0.005535038	2.25674118	1.949993578	120.1866412
0.849059288	0.004764809	2.253465422	1.945702158	120.1908104
0.887106309	0.005393558	2.252648168	1.942998963	120.1923849
0.876262288	0.005242703	2.254417529	1.949334217	120.1944931
0.850879773	0.004881306	2.254157923	1.945385559	120.1945659
0.850064011	0.004833658	2.249534578	1.940263903	120.194762
0.851140619	0.004868525	2.252346677	1.94673026	120.1950471
0.876157691	0.005244773	2.258306861	1.95102949	120.19602
0.845240658	0.004811954	2.255622783	1.948263705	120.1973571
0.875276981	0.005227402	2.251021048	1.941567082	120.1975707
0.899641496	0.00552634	2.258167089	1.949877082	120.198532
0.857517096	0.004955356	2.251032624	1.940614944	120.1987253
0.864717697	0.005052672	2.24876053	1.93814202	120.2003683
0.839688964	0.004702249	2.254752171	1.945367823	120.2034533
0.850821522	0.004838081	2.255651759	1.946967181	120.2037546
0.849025491	0.004805537	2.255849239	1.949706538	120.2042526
0.837432977	0.004661136	2.250376159	1.943231116	120.2042575
0.843378306	0.004770852	2.246929538	1.937610946	120.207008];

GA_CSA = [0.892066578	0.005409464	2.250676781	1.944152143	120.1723832
0.893970629	0.005457474	2.248230594	1.941420791	120.1746537
0.87862732	0.005268592	2.252159943	1.943804604	120.1778241
0.884146717	0.005354352	2.254080829	1.946202089	120.1787957
0.899111441	0.005557351	2.251724178	1.946335746	120.1788021
0.864469546	0.005014293	2.249862143	1.941676406	120.181962
0.849059288	0.004764809	2.253465422	1.945702158	120.1908104
0.887106309	0.005393558	2.252648168	1.942998963	120.1923849
0.876262288	0.005242703	2.254417529	1.949334217	120.1944931
0.850064011	0.004833658	2.249534578	1.940263903	120.194762
0.876157691	0.005244773	2.258306861	1.95102949	120.19602
0.845240658	0.004811954	2.255622783	1.948263705	120.1973571
0.899641496	0.00552634	2.258167089	1.949877082	120.198532
0.857517096	0.004955356	2.251032624	1.940614944	120.1987253
0.839688964	0.004702249	2.254752171	1.945367823	120.2034533
0.849025491	0.004805537	2.255849239	1.949706538	120.2042526
0.837432977	0.004661136	2.250376159	1.943231116	120.2042575
0.831922981	0.004616771	2.254100791	1.945915944	120.2111552
0.887309848	0.00535999	2.249268828	1.938415349	120.2133917
0.864394254	0.005063808	2.257611073	1.94662177	120.2154799
0.880517157	0.005285058	2.256690385	1.944286389	120.2156448
0.832272782	0.004632465	2.257199259	1.947507682	120.217362
0.841571784	0.004764098	2.254415522	1.942697892	120.219373
0.856261173	0.004925114	2.250190139	1.937714922	120.2249369
0.824394854	0.004480659	2.252064404	1.941491308	120.2258864
0.843528476	0.004769893	2.250282646	1.938107284	120.228263
0.84784801	0.004843657	2.254420707	1.942605305	120.2307452
0.837366968	0.004691908	2.259568855	1.952236999	120.2447788
0.817181526	0.004293215	2.246627231	1.936828386	120.2463184
0.86914621	0.005142383	2.262899025	1.945002103	120.3507293];

CSA_GA = [0.9	0.003	2.262053185	1.943378884	120.9519106
0.899999297	0.003000003	2.262233747	1.943481736	120.9519595
0.899999835	0.003	2.262464478	1.94367826	120.9520172
0.899993767	0.003	2.261928164	1.943141923	120.9520321
0.9	0.003001474	2.261787538	1.943067651	120.9520655
0.899998959	0.003000056	2.262631414	1.943912999	120.9520658
0.9	0.003000057	2.262619578	1.943777648	120.9520726
0.9	0.003000015	2.262221604	1.943480663	120.9521208
0.899997469	0.003000048	2.261162738	1.942462449	120.9522473
0.899993134	0.003000011	2.263083651	1.944386936	120.9523522
0.899994252	0.003	2.262575442	1.94378656	120.9523613
0.8999863	0.003	2.263221645	1.944529846	120.9524834
0.899983548	0.003000033	2.260757344	1.941889822	120.9526495
0.899993347	0.00300024	2.262901453	1.944194403	120.9526829
0.899972212	0.003000143	2.26270714	1.944286018	120.9526887
0.899980188	0.003000192	2.262260566	1.943541451	120.9527048
0.899974173	0.003	2.262852529	1.943964225	120.952725
0.899914646	0.003002284	2.263523415	1.944554513	120.9527599
0.899971294	0.00300015	2.26164777	1.943015012	120.9527945
0.899887082	0.003000271	2.263536248	1.944676184	120.952816
0.9	0.003000736	2.261802253	1.943007263	120.9528477
0.899721748	0.003002086	2.262933727	1.944027956	120.9530578
0.89970644	0.003004876	2.263282592	1.944625141	120.953174
0.899830995	0.00300068	2.263709476	1.945321501	120.9537474
0.899876672	0.003000308	2.264536849	1.945384861	120.9541437
0.9	0.003000574	2.264672838	1.946006517	120.9544593
0.899946836	0.003001101	2.264706703	1.945559049	120.9549672
0.899898285	0.003000052	2.266531925	1.947968382	120.9597874
0.899869675	0.003003511	2.266627962	1.94821492	120.9607913
0.898857891	0.003003788	2.271552578	1.952888016	120.9841701];


% load real data
load M22_gas_fhp
load M22_offline
load M22_volfeed

t = M22_offline(:,1);
X = M22_offline(:,4);
S = M22_offline(:,3);
Pd = M22_offline(:,7);
tfeed = M22_volfeed(:, 1);
Fd = M22_volfeed(:,3);
Vd = M22_volfeed(:,2);

t0 = 4.3; tf = 14;

Xdop = interp1(t, X, t0);
Sdop = interp1(t, S, t0);
Pdop = interp1(t, Pd, t0);
t = t(2:21); t = [4.3; t(2:end)];
Xd1 = X(2:21);Xd = [Xdop; Xd1];
Sd1 = S(2:21);Sd = [Sdop; Sd1];
Pd1 = Pd(2:21);Pd = [Pdop; Pd1];
F = interp1(tfeed, Fd, t);
V = interp1(tfeed, Vd, t);
F(6) = 0.06;
F(18) = 0.065;
F(19) = 0.06;

So = 500;
t1 = t(1:11);
X1 = Xd(1:11); S1 = Sd(1:11); P1 = Pd(1:11);
F1 = F(1:11); V1 = V(1:11);

X0 = X1(1); S0 = S1(1); P0 = P1(1);


% Best parameters
Mmax = 0.89998018767737;	Ks = 0.00300019162246;	K1 = 2.26226056623495;	K5 = 1.94354145084506;	% Jga = 120.95270476575600
Mmax_csa = 0.88769421870216;	Ks_csa = 0.00535415019647;	K1_csa = 2.24984630248432;	K5_csa = 1.94337548533764;	% J = 120.17307273937000
Mmax_ga_csa = 0.89206657818258;	Ks_ga_csa = 0.00540946406971;	K1_ga_csa = 2.25067678055263;	K5_ga_csa = 1.94415214262800;	% J = 120.17238315086600
Mmax_csa_ga = 0.90000000000000;	Ks_csa_ga = 0.00300000000000;	K1_csa_ga = 2.26205318539721;	K5_csa_ga = 1.94337888356766;	% J = 120.951910573899000

% Mmax = 0.890318372951313;	Ks = 0.0286767683927728;	K1 = 2.27164300351768;	K5 = 1.96030956880962;	% Jga = 120.95270476575600
% Mmax_csa = 0.753967199;	Ks_csa = 0.008975053;	K1_csa = 2.273647722;	K5_csa = 1.945471739;	% J = 120.17307273937000
% Mmax_csa_ga = 0.780312553;	Ks_ga_csa = 0.003906655;	K1_ga_csa = 2.259297568;	K5_ga_csa = 1.944326746;	% J = 120.17238315086600
% Mmax_ga_csa = 0.753967199;	Ks_csa_ga = 0.008975053;	K1_csa_ga = 2.273647722;	K5_csa_ga = 1.945471739;	% J = 120.951910573899000
% Mmax_ga_csa = 0.780312553;	Ks_ga_csa = 0.003906655;	K1_ga_csa = 2.259297568;	K5_ga_csa = 1.944326746;	% J = 120.17238315086600
% Mmax_csa_ga = 0.753967199;	Ks_csa_ga = 0.008975053;	K1_csa_ga = 2.273647722;	K5_csa_ga = 1.945471739;	% J = 120.951910573899000


% options = simset('solver', 'ode45', 'RelTol', 1e-4, 'AbsTol', 1e-6, 'MaxStep', 1);
TIMESPAN = [t1(1) t1(length(t1))]; 
options = [];
[Ta, Xa, Ya] = sim('Model_xspmono_ga',  TIMESPAN, options, []);
tmod1 = Ta; Xmod1 = Ya(:, 1); Smod1 = Ya(:, 2); Pmod1 = Ya(:, 3);
Xmod1a = interp1(tmod1, Xmod1, t1); 
Smod1a = interp1(tmod1, Smod1, t1);
Pmod1a = interp1(tmod1, Pmod1, t1);
Xer1 = Xmod1a - X1; Ser1 = Smod1a - S1; Per1 = Pmod1a - P1;
E1 = sum(Xer1.*Xer1) + sum(Ser1.*Ser1) + sum(Per1.*Per1)

[Tb, Xb, Yb] = sim('Model_xspmono_csa',  TIMESPAN, options, []);
tmod2 = Tb; Xmod2 = Yb(:, 1); Smod2 = Yb(:, 2); Pmod2 = Yb(:, 3);
Xmod2b = interp1(tmod2, Xmod2, t1); 
Smod2b = interp1(tmod2, Smod2, t1);
Pmod2b = interp1(tmod2, Pmod2, t1);
Xer2 = Xmod2b - X1; Ser2 = Smod2b - S1; Per2 = Pmod2b - P1;
E2 = sum(Xer2.*Xer2) + sum(Ser2.*Ser2) + sum(Per2.*Per2)

[Tc, Xc, Yc] = sim('Model_xspmono_csa_ga',  TIMESPAN, options, []);
tmod3 = Tc; Xmod3 = Yc(:, 1); Smod3 = Yc(:, 2); Pmod3 = Yc(:, 3);
Xmod3c = interp1(tmod3, Xmod3, t1); 
Smod3c = interp1(tmod3, Smod3, t1);
Pmod3c = interp1(tmod3, Pmod3, t1);
Xer3 = Xmod3c - X1; Ser3 = Smod3c - S1; Per3 = Pmod3c - P1;
E3 = sum(Xer3.*Xer3) + sum(Ser3.*Ser3) + sum(Per3.*Per3)

[Td, Xd, Yd] = sim('Model_xspmono_ga_csa',  TIMESPAN, options, []);
tmod4 = Td; Xmod4 = Yd(:, 1); Smod4 = Yd(:, 2); Pmod4 = Yd(:, 3);
Xmod4d = interp1(tmod4, Xmod4, t1); 
Smod4d = interp1(tmod4, Smod4, t1);
Pmod4d = interp1(tmod4, Pmod4, t1);
Xer4 = Xmod4d - X1; Ser4 = Smod4d - S1; Per4 = Pmod4d - P1;
E4 = sum(Xer4.*Xer4) + sum(Ser4.*Ser4) + sum(Per4.*Per4)


% figure(10), plot(t1, X1, 'k*', 'LineWidth',2), hold on,  
% set(gca,'fontsize', 14);
% plot(tmod1, Xmod1, 'g--', 'LineWidth',2 ), hold on, 
% plot(tmod2, Xmod2, 'm', 'LineWidth',2 ), hold on, 
% plot(tmod3, Xmod3, 'b-.', 'LineWidth',2), hold on,
% % plot(tmod4, Xmod4, 'b--', 'LineWidth',2 ), hold on, 
% % plot(tmod5, Xmod5, 'r-.', 'LineWidth',2 ), grid
% title('Results from optimization'), 
% xlabel('Time, [h]'), ylabel('Biomass, [g.L^{-1}]')
% % legend('Experimental data','GA model','CSA model','GA-CSA model','CSA-GA model', 'Location', 'northwest');
% legend('Experimental data','GA model','CSA model','GA-CSA model', 'Location', 'northwest');
% 
% figure(11), plot(t1, S1, 'k*', 'LineWidth',2), hold on, 
% set(gca,'fontsize', 14);
% plot(tmod1, Smod1, 'g--', 'LineWidth',2 ), hold on, 
% plot(tmod2, Smod2, 'm', 'LineWidth',2), hold on, 
% plot(tmod3, Smod3, 'b-.', 'LineWidth',2),  hold on, 
% % plot(tmod4, Smod4, 'b--', 'LineWidth',2 ), hold on, 
% % plot(tmod5, Smod5, 'r-.', 'LineWidth',2 ),  grid
% title('Results from optimization'), 
% xlabel('Time, [h]'), ylabel('Substrate, [g.L^{-1}]')
% % legend('Experimental data','GA model','CSA model','GA-CSA model','CSA-GA model');
% legend('Experimental data','GA model','CSA model','GA-CSA model');
%  
% figure(12), plot(t1, P1, 'k*', 'LineWidth', 2), hold on, 
% set(gca,'fontsize', 14);
% plot(tmod1, Pmod1, 'g--', 'LineWidth', 2 ), hold on, 
% plot(tmod2, Pmod2, 'm', 'LineWidth', 2), hold on, 
% plot(tmod3, Pmod3, 'b-.', 'LineWidth', 2),  hold on, 
% % plot(tmod4, Pmod4, 'b--', 'LineWidth', 2 ), hold on, 
% % plot(tmod5, Pmod5, 'r-.', 'LineWidth',2 ),  grid
% title('Results from optimization'), 
% xlabel('Time, [h]'), ylabel('Phytase, [g.L^{-1}]')
% % legend('Experimental data','GA model','CSA model','GA-CSA model','CSA-GA model', 'Location', 'northwest');
% legend('Experimental data','GA model','CSA model','GA-CSA model', 'Location', 'northwest');

%% Boxplots

figure(13)
set(gca,'fontsize', 14)
h = boxplot([GA(:, 5) CSA(:, 5) GA_CSA(:, 5)], 'labels', {'GA','CSA','GA-CSA'})% 'medianstyle', 'target', 'notch', 'on')%,  'colors',hsv(7))
h = boxplot([GA(:, 5) CSA(:, 5) GA_CSA(:, 5) CSA_GA(:, 5)], 'labels', {'GA','CSA','GA-CSA','CSA-GA'})% 'medianstyle', 'target', 'notch', 'on')%,  'colors',hsv(7))

set(findobj(get(h(1), 'parent'), 'type', 'text'), 'fontsize', 14);
ylabel('Objective function value \it J')
% 
figure(14)
set(gca,'fontsize', 14)
h = boxplot([GA(:,1) CSA(:, 1) GA_CSA(:, 1) CSA_GA(:, 1)],'labels',{'GA','CSA','GA-CSA','CSA-GA'})
set(findobj(get(h(1), 'parent'), 'type', 'text'), 'fontsize', 14);
ylabel('parameter {\it \mu_{max}}, [h^{-1}]')
% 
figure(15)
set(gca,'fontsize', 14)
h = boxplot([GA(:, 2) CSA(:, 2) GA_CSA(:, 2) CSA_GA(:, 2) ],'labels',{'GA','CSA','GA-CSA','CSA-GA'})
set(findobj(get(h(1), 'parent'), 'type', 'text'), 'fontsize', 14);
ylabel('parameter {\it k_S}, [g.L^{-1}]')

figure(16) 
set(gca,'fontsize', 14)
h = boxplot([GA(:, 3) CSA(:, 3) GA_CSA(:, 3) CSA_GA(:, 3) ],'labels',{'GA','CSA','GA-CSA','CSA-GA'})
set(findobj(get(h(1), 'parent'), 'type', 'text'), 'fontsize', 14);
ylabel('parameter {\it Y_{SX}}, [g.g^{-1}]')

figure(17) 
set(gca,'fontsize', 14)
h = boxplot([GA(:, 4) CSA(:, 4) GA_CSA(:, 4) CSA_GA(:, 4)],'labels',{'GA','CSA','GA-CSA','CSA-GA'})
set(findobj(get(h(1), 'parent'), 'type', 'text'), 'fontsize', 14);
ylabel('parameter {\it Y_{PX}}, [g.g^{-1}]')

figure(13)
set(gca,'fontsize', 14)
h = boxplot([GA(:, 5) CSA(:, 5) GA_CSA(:, 5)], 'labels', {'GA','CSA','GA-CSA'})% 'medianstyle', 'target', 'notch', 'on')%,  'colors',hsv(7))
set(findobj(get(h(1), 'parent'), 'type', 'text'), 'fontsize', 14);
ylabel('Objective function value \it J')

figure(14)
set(gca,'fontsize', 14)
h = boxplot([GA(:,1) CSA(:, 1) GA_CSA(:, 1)],'labels',{'GA','CSA','GA-CSA'})
set(findobj(get(h(1), 'parent'), 'type', 'text'), 'fontsize', 14);
ylabel('parameter {\it \mu_{max}}, [h^{-1}]')
% 
figure(15)
set(gca,'fontsize', 14)
h = boxplot([GA(:, 2) CSA(:, 2) GA_CSA(:, 2)],'labels',{'GA','CSA','GA-CSA'})
set(findobj(get(h(1), 'parent'), 'type', 'text'), 'fontsize', 14);
ylabel('parameter {\it k_S}, [g.L^{-1}]')

figure(16) 
set(gca,'fontsize', 14)
h = boxplot([GA(:, 3) CSA(:, 3) GA_CSA(:, 3)],'labels',{'GA','CSA','GA-CSA'})
set(findobj(get(h(1), 'parent'), 'type', 'text'), 'fontsize', 14);
ylabel('parameter {\it Y_{S/X}}, [g.g^{-1}]')

figure(17) 
set(gca,'fontsize', 14)
h = boxplot([GA(:, 4) CSA(:, 4) GA_CSA(:, 4)],'labels',{'GA','CSA','GA-CSA'})
set(findobj(get(h(1), 'parent'), 'type', 'text'), 'fontsize', 14);
ylabel('parameter {\it Y_{P/X}}, [g.g^{-1}]')

%% Histograms

%% Objective function
figure(18), set(gca,'fontsize', 14)
hist(GA(:, 5));
title('GA'), xlabel('Objective function, \it{J}'), ylabel('Frequency')

figure(19), set(gca,'fontsize', 14)
hist(CSA(:, 5));
title('CSA'), xlabel('Objective function, \it{J}'), ylabel('Frequency')

figure(20), set(gca,'fontsize', 14)
hist(GA_CSA(:, 5));
title('GA-CSA'), xlabel('Objective function, \it{J}'), ylabel('Frequency')

figure(21), set(gca,'fontsize', 14)
hist(CSA_GA(:, 5));
title('CSA-GA'), xlabel('Objective function, \it{J}'), ylabel('Frequency')

%% Parameters
figure(22), set(gca,'fontsize', 14)
hist(GA(:, 1));
title('GA'), xlabel('parameter {\it \mu_{max}}, [h^{-1}]'), ylabel('Frequency')

figure(23), set(gca,'fontsize', 14)
hist(CSA(:, 1));
title('CSA'), xlabel('parameter {\it \mu_{max}}, [h^{-1}]'), ylabel('Frequency')

figure(24), set(gca,'fontsize', 14)
hist(GA_CSA(:, 1));
title('GA-CSA'), xlabel('parameter {\it \mu_{max}}, [h^{-1}]'), ylabel('Frequency')

figure(25), set(gca,'fontsize', 14)
hist(CSA_GA(:, 1));
title('CSA-GA'), xlabel('parameter {\it \mu_{max}}, [h^{-1}]'), ylabel('Frequency')

%%
figure(26), set(gca,'fontsize', 14)
hist(GA(:, 2));
title('GA'), xlabel('parameter {\it k_S}, [g.L^{-1}]'), ylabel('Frequency')

figure(27), set(gca,'fontsize', 14)
hist(CSA(:,2));
title('CSA'), xlabel('parameter {\it k_S}, [g.L^{-1}]'), ylabel('Frequency')

figure(28), set(gca,'fontsize', 14)
hist(GA_CSA(:,2));
title('GA-CSA'),  xlabel('parameter {\it k_S}, [g.L^{-1}]'), ylabel('Frequency')

figure(29), set(gca,'fontsize', 14)
hist(CSA_GA(:,2));
title('CSA-GA'),  xlabel('parameter {\it k_S}, [g.L^{-1}]'), ylabel('Frequency')

%%
figure(30), set(gca,'fontsize', 14)
hist(GA(:,3));
title('GA'), xlabel('parameter {\it Y_{SX}}, [g.g^{-1}]'),ylabel('Frequency')

figure(31), set(gca,'fontsize', 14)
hist(CSA(:,3));
title('CSA'), xlabel('parameter {\it Y_{SX}}, [g.g^{-1}]'), ylabel('Frequency')

figure(32), set(gca,'fontsize', 14)
hist(GA_CSA(:,3));
title('GA-CSA'), xlabel('parameter {\it Y_{SX}}, [g.g^{-1}]'), ylabel('Frequency')

figure(33), set(gca,'fontsize', 14)
hist(CSA_GA(:,3));
title('CSA-GA'), xlabel('parameter {\it Y_{SX}}, [g.g^{-1}]'), ylabel('Frequency')

%%
figure(34), set(gca,'fontsize', 14)
hist(GA(:,4));
title('GA'), xlabel('parameter {\it Y_{PX}}, [g.g^{-1}]'),ylabel('Frequency')

figure(35), set(gca,'fontsize', 14)
hist(CSA(:,4));
title('CSA'), xlabel('parameter {\it Y_{PX}}, [g.g^{-1}]'), ylabel('Frequency')

figure(36), set(gca,'fontsize', 14)
hist(GA_CSA(:,4));
title('GA-CSA'), xlabel('parameter {\it Y_{PX}}, [g.g^{-1}]'), ylabel('Frequency')

figure(37), set(gca,'fontsize', 14)
hist(CSA_GA(:,4));
title('CSA-GA'), xlabel('parameter {\it Y_{PX}}, [g.g^{-1}]'), ylabel('Frequency')
% 
%%
% % Wilcoxon test
% 
%GA vs CSA
[P12,H12,STATS12] = ranksum(GA(:, 5), CSA(:, 5))
%GA vs GA-CSA
[P13,H13,STATS13] = ranksum(GA(:, 5), GA_CSA(:, 5))
%GA vs CSA-GA
[P14,H14,STATS14] = ranksum(GA(:, 5), CSA_GA(:, 5))
%CSA vs GA-CSA
[P15,H15,STATS15] = ranksum(CSA(:, 5), GA_CSA(:, 5))
%CSA vs CSA-GA
[P16,H16,STATS16] = ranksum(CSA(:, 5), CSA_GA(:, 5))


%%
% Friedman test

%GA vs CSA
[P1,TABLE1,STATS1] = friedman([GA(:, 5)'; CSA(:, 5)'])
%GA vs GA-CSA
[P2,TABLE2,STATS2] = friedman([GA(:, 5)'; GA_CSA(:, 5)'])
%GA vs CSA-GA
[P3,TABLE3,STATS3] = friedman([GA(:, 5)'; CSA_GA(:, 5)'])
%CSA vs GA-CSA
[P4,TABLE4,STATS4] = friedman([CSA(:, 5)'; GA_CSA(:, 5)'])
%CSA vs CSA-GA
[P5,TABLE5,STATS5] = friedman([CSA(:, 5)'; CSA_GA(:, 5)'])

%%
%ANOVA
set(gca,'fontsize', 14);
group = {'GA', 'CSA', 'GA-CSA', 'CSA-GA'};
[p,tbl,stats] = anova1([GA(:, 5) CSA(:, 5) GA_CSA(:, 5) CSA_GA(:, 5)], group)
set(gca,'fontsize', 14);

ylabel('{\it J} value')
title('Parameter identification of {\it{E. coli}} - ANOVA')

set(gca,'fontsize', 14);
group = {'GA', 'CSA', 'GA-CSA', 'CSA-GA'};
[p1a,tbl1a,stats1a] = anova1([GA(:, 5) CSA(:, 5) GA_CSA(:, 5) CSA_GA(:, 5)], group)
set(gca,'fontsize', 14);

ylabel('{\it J} value')
title('Parameter identification of {\it{E. coli}} - ANOVA')

set(gca,'fontsize', 14);
group = {'GA', 'CSA'};
[p1b,tbl1b,stats1b] = anova1([GA(:, 5) CSA(:, 5)], group)
set(gca,'fontsize', 14);
% 
ylabel('{\it J} value')
title('Parameter identification of {\it{E. coli}} - ANOVA')
% 
set(gca,'fontsize', 14);
group = {'GA', 'GA-CSA'};
[p1c,tbl1c,stats1c] = anova1([GA(:, 5) GA_CSA(:, 5)], group)
set(gca,'fontsize', 14);

ylabel('{\it J} value')
title('Parameter identification of {\it{E. coli}} - ANOVA')

set(gca,'fontsize', 14);
group = {'GA', 'CSA-GA'};
[p1d,tbl1d,stats1d] = anova1([GA(:, 5) CSA_GA(:, 5)], group)
set(gca,'fontsize', 14);

ylabel('{\it J} value')
title('Parameter identification of {\it{E. coli}} - ANOVA')

set(gca,'fontsize', 14);
group = {'CSA', 'GA-CSA'};
[p1e,tbl1e,stats1e] = anova1([CSA(:, 5) GA_CSA(:, 5)], group)
set(gca,'fontsize', 14);

ylabel('{\it J} value')
title('Parameter identification of {\it{E. coli}} - ANOVA')

set(gca,'fontsize', 14);
group = {'CSA', 'CSA-GA'};
[p1f,tbl1f,stats1f] = anova1([CSA(:, 5) CSA_GA(:, 5)], group)
set(gca,'fontsize', 14);

ylabel('{\it J} value')
title('Parameter identification of {\it{E. coli}} - ANOVA')
% 
% 


%%

